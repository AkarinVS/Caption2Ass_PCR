Caption2Ass_PCR.exe（プレα版）
＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
「Caption2Ass 補完計画（Cleanup code）」を改造したものです。
ass出力の場合に字幕の位置・色・ルビ(ふりがな)を再現するようにしました。

【使用許諾条件】
このソフトを使用して得られるいかなるデータを、インターネット上にアップロードしたり、
あるいはインターネット以外であっても使用者以外の人間に渡すことを前提とした使用を
一切禁じます。
使用者個人の研究目的という条件の下でのみ、当ソフトの使用が許されます。
この条件は、Caption2Ass_PCR.exeの過去のバージョンすべてに該当します。
守れない場合は、いかなる記憶装置にインストールあるいは保存した当ソフトと
得られたデータのすべてを即刻消去しなければなりません。
万一、上記の許諾条件外の使用が発覚した際には、本ソフトの公開を停止します。

【再配布】
再配布を固く禁じます。

【使用方法】
同梱のCaption_PCR.dllを使ってください。このdllは改造版0.1.1.1を更に改造したものです。

1. Caption2Ass_PCR.exe と Caption_PCR.dllを同じフォルダーに置く。

2. cmd.exeを実行する。

3. Caption2Ass_PCR.exe "C:\MyRecordedTsFile.ts"
      このように Caption2Ass_PCR.exeを実行してください。
      C:\MyRecordedTsFile.tsは保存されたTSファイルの名前です。
      (Double quotation marksを忘れないで。)

   出力字幕タイプ指定可能。(-format {srt|ass|taw|dual})
   Ex: Caption2Ass_PCR.exe -format srt "C:\MyRecordedTsFile.ts"

【オプションについて】
・「-format」
     字幕ファイルのフォーマットを指定(省略時はass)
         srt : srtフォーマット、文字コードはUTF8(BOM)
         ass : assフォーマット、文字コードはUTF8(BOM)
         taw : srtフォーマット、文字コードはシフト・ジス(S-JIS)
         dual : 一回の処理でsrtとassの両方を作る。欲張りな私用の指定
・「-PMT_PID」
     PMT Pid指定もできる。PIDは Hex
・「-delay」
     字幕のタイミングを任意のミリ秒単位（整数値）で遅らせます。
     負の整数値を使ってタイミングを早めることも出来ます。
     　Ex:　-delay -300
     　300msec字幕を早めます。
・「-asstype」
     ass出力の時に事前にiniファィルで指定した、フォント名やサイズ等を
     示す「セクション名」を指定する
・「-i」
     入力ファィルを他のオプションと同じ様に指定できる
     今までのバージョンと同じ様に「-i」無しでも使用可能
・「-o」
     入力ファィルを他のオプションと同じ様に指定できる
     今までのバージョンと同じ様に「-o」無しでも使用可能

【iniファィルについて】
・iniファィルセクションを追加して字幕スタイルを変更できます
<<<<<<--------
[Default]
Comment1="Script generated by Aegisub v2.1.2 RELEASE PREVIEW (SVN r1987, amz)"
Comment2="http://www.aegisub.net"
Comment3=
PlayResX=1920
PlayResY=1080
DefaultFontname="MS UI Gothic"
DefaultFontsize=90
RubiFontname="MS UI Gothic"
RubiFontsize=50
<<<<<<--------
この[Default]セクションを参考にして、好みのフォント名やサイズを指定した
セクションを作って下さい。
ドラマやアニメでは、フォントを替えてみることも、面白いかも！？

【同梱の「Caption2Ass_PCR_D.exe」について】
・このプログラムは、Debug用でログ・ファイルを作成します
  何か問題があれば、このプログラムでログ・ファイルを作成して
  報告して下されば、対応できるかもしれない

【課題】
・全角１６文字を超える場合の改行処理
・Caption.dllの改造版0.1.1.4に対応出来ないか？

【謝辞】
Special thanks to
・「Caption2Ass 補完計画（Cleanup code）」を公開してくれた方
・odaruさん、
・EDCBの中の人さん、
・人柱になってデバッグにお付き合いいただいている方々
皆さんのおかげでつくれました

【変更履歴】
2011-09-12
0,1,0,4
・オプションの充実（odaruさん版やmod1さん版を参考にして）
      -format に taw と dualを追加した
      -delay を追加した
      -asstype を追加した
・フォント名やサイズ等をiniファィル化
      iniファィルにセクションを追加して、「-asstype」のオプションで
      セクションを指定すれば、好みの表示に出来る
・半角文字に対応
      HDUS関係ファイル置き場の「up0209.zip 字幕 Plugin For TVTest(20081215)」の
      「CommRoutine.cpp」と「CommRoutine.h」を移植して実現
・字幕のタイミングを修正
・字幕の位置を調整
・改造版0.1.1.1を更に改造したCaption_PCR.dllを同梱

2011-09-04
0,1,0,3
・字幕のタイミングを修正
・字幕の位置を調整
・改造版0.1.1.1を更に改造したCaption_PCR.dllを同梱

2011-08-27
0,1,0,2
・Caption2Ass_PCR.exeとして公開
・改造版0.1.1.1を更に改造したCaption.dllを同梱
・字幕の色が白色の時には色の指定を省略した

2011-08-25
0,1,0,1
・Caption2Ass_PC.exeとして公開
・字幕の位置・色・ルビ(ふりがな)に対応

2011-08-XX
0,1,0,0
・「Caption2Ass 補完計画（Cleanup code）」をVC++2010でビルドしただけ。
  ここが、出発点。
