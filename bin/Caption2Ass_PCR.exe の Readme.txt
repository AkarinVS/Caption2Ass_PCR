Caption2Ass_PCR.exe（プレα版）
＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
「Caption2Ass 補完計画（Cleanup code）」を改造したものです。
ass出力の場合に字幕の位置・色・ルビ(ふりがな)を再現するようにしました。
srt出力の場合に字幕の色を再現するようにしました。

【使用許諾条件】
このソフトを使用して得られるいかなるデータを、インターネット上にアップロードしたり、
あるいはインターネット以外であっても使用者以外の人間に渡すことを前提とした使用を
一切禁じます。
使用者個人の研究目的という条件の下でのみ、当ソフトの使用が許されます。
この条件は、Caption2Ass_PCR.exeの過去のバージョンすべてに該当します。
守れない場合は、いかなる記憶装置にインストールあるいは保存した当ソフトと
得られたデータのすべてを即刻消去しなければなりません。
万一、上記の許諾条件外の使用が発覚した際には、本ソフトの公開を停止します。

【再配布】
再配布を固く禁じます。

【使用方法】
非常に残念なことに
・mod1さんが「Caption.dll 0114改造版」の公開を止められました

しかたないので、mod1さんが以前に公開されていた
「Caption.dll 0111改造版」のソースコードと
「EpgDataCap_Bon（人柱版８．５６）」のソースコード
「odaruさんの字幕 Plugin For TVTest(20081216)」の
ソースコードを元にしてユニコードに対応した
「Caption.dll 0200改造版」を作って、同梱します

＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊

1. Caption2Ass_PCR.exe と 「Caption.dll 0200改造版」を同じフォルダーに置く。

2. cmd.exeを実行する。

3. Caption2Ass_PCR.exe "C:\MyRecordedTsFile.ts"
      このように Caption2Ass_PCR.exeを実行してください。
      C:\MyRecordedTsFile.tsは保存されたTSファイルの名前です。
      (Double quotation marksを忘れないで。)

   出力字幕タイプ指定可能。(-format {srt|ass|taw|dual})
   Ex: Caption2Ass_PCR.exe -format srt "C:\MyRecordedTsFile.ts"

【オプションについて】
・「-format」
     字幕ファイルのフォーマットを指定(省略時はass)
         srt : srtフォーマット、文字コードはUTF8(BOM)
         ass : assフォーマット、文字コードはUTF8(BOM)
         taw : srtフォーマット、文字コードはシフト・ジス(S-JIS)
         dual : 一回の処理でsrtとassの両方を作る。欲張りな私用の指定
・「-PMT_PID」
     PMT Pid指定もできる。PIDは Hex
・「-delay」
     字幕のタイミングを任意のミリ秒単位（整数値）で遅らせます。
     負の整数値を使ってタイミングを早めることも出来ます。
     　Ex:　-delay -300
     　300msec字幕を早めます。
・「-asstype」
     ass出力の時に事前にiniファィルで指定した、フォント名やサイズ等を
     示す「セクション名」を指定する
・「-srtornament」
     srt出力の時に色をHTML装飾で出力する
     省略した時には装飾しない
     フォーマットに「taw」を指定していれば、無視します
・「-log」
     不具合が発生したら、このオプションを指定してログ・ファイルを作成します
     報告して下されば、対応できるかもしれない
・「-i」
     入力ファィルを他のオプションと同じ様に指定できる
     今までのバージョンと同じ様に「-i」無しでも使用可能
・「-o」
     入力ファィルを他のオプションと同じ様に指定できる
     今までのバージョンと同じ様に「-o」無しでも使用可能

【iniファィルについて】
・iniファィルセクションを追加して字幕スタイルを変更できます
<<<<<<--------
[SWFModeOffset]
SWF0offset=0
SWF5offset=0
SWF7offset=0
SWF9offset=0
SWF11offset=0
[Default]
Comment1="Script generated by Aegisub v2.1.2 RELEASE PREVIEW (SVN r1987, amz)"
Comment2="http://www.aegisub.net"
Comment3=
PlayResX=1920
PlayResY=1080
DefaultFontname="MS UI Gothic"
DefaultFontsize=90
DefaultStyle='&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,5,0,1,2,2,1,10,10,10,0'
RubiFontname="MS UI Gothic"
RubiFontsize=50
RubiStyle='&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,2,2,1,10,10,10,0'
<<<<<<--------
[SWFModeOffset]セクションは、字幕全体を上下させる為の設定です
ARIBの規格の標準文字でHDであれば、60を指定すると１行下になります

[Default]セクションの各項目がassのヘッダーに反映されます
参考にして、好みのフォント名やサイズを指定した
セクションを作って下さい。
ドラマやアニメでは、フォントを替えてみることも、面白いかも！？

【課題】
・全角１６文字を超える場合の改行処理

【謝辞】
Special thanks to
・「Caption2Ass 補完計画（Cleanup code）」を公開してくれた方
・odaruさん、
・mod1の中の人さん、
・EDCBの中の人さん、
・字幕抽出ツール C-Cats の作者さん、
・人柱になってデバッグにお付き合いいただいている方々
皆さんのおかげでつくれました

【変更履歴】
2011-11-27
0,2,0,0
・ユニコードに対応した「Caption.dll 0200改造版」を同梱
・「Caption.dll 0200改造版」を使用していれば、「taw」以外のときに
  ユニコードで記述した設定ファイルを読込みます

2011-10-23
0,1,1,1
・前回「PCRのPID取得位置を修正した」による不具合が発生した為に
  PCRのPID取得位置を戻した。
・PMT判定を強化した

2011-10-14
0,1,1,0
・PCRのPID取得位置を修正した
・srt出力の場合に色をHTMLタグで出力出来るようにした
・ログ・ファイルの項目を増やした

2011-10-12
0,1,0,9
「【開発】 TS関連ソフトウェア総合スレ Part9」
の241にて字幕の表示時間周りにおける不具合をを確認して
修正もして頂いたので、これをver.0109として採用させて頂きました
修正の理由と内容に付いての文書も添付されていたので、
大変お世話になりました
・PCR,PTSを33ビットで処理
・字幕全体が800ミリ程度早く表示されるの修正
・PCR巡回発生後の字幕時間に100ミリ程度のズレの修正
「Caption2Ass_PCR_ver.0108を修正してみた」
ttp://2sen.dip.jp/cgi-bin/dtvup/source/up0762.zip


2011-09-22
0,1,0,8
・SD放送の字幕の位置を微調整した
・iniファィルを拡張して調整可能な項目を増やした
・ログ・ファイルの項目を増やした

2011-09-19
0,1,0,7
・SD放送の字幕の対応を改善したつもり

2011-09-18
0,1,0,6
・字幕のタイミングを修正して、CS放送に対応したつもり
   メモ
   時間の基準となるPCRパケットが映像パケットと同じPIDで
   送信されていたので、PCRパケットのチェックを強化した

2011-09-16
0,1,0,5
・SD放送の字幕に対応したつもり
・オプションに「-log」を追加した
      この変更により「Caption2Ass_PCR_D.exe」の同梱を廃止した
・mod1の中の人のCaption.dll(0.1.1.4)に対応した
      この変更により「Caption_PCR.dll」の同梱を廃止した

2011-09-12
0,1,0,4
・オプションの充実（odaruさん版やmod1さん版を参考にして）
      -format に taw と dualを追加した
      -delay を追加した
      -asstype を追加した
・フォント名やサイズ等をiniファィル化
      iniファィルにセクションを追加して、「-asstype」のオプションで
      セクションを指定すれば、好みの表示に出来る
・半角文字に対応
      HDUS関係ファイル置き場の「up0209.zip 字幕 Plugin For TVTest(20081215)」の
      「CommRoutine.cpp」と「CommRoutine.h」を移植して実現
・字幕のタイミングを修正
・字幕の位置を調整
・改造版0.1.1.1を更に改造したCaption_PCR.dllを同梱

2011-09-04
0,1,0,3
・字幕のタイミングを修正
・字幕の位置を調整
・改造版0.1.1.1を更に改造したCaption_PCR.dllを同梱

2011-08-27
0,1,0,2
・Caption2Ass_PCR.exeとして公開
・改造版0.1.1.1を更に改造したCaption.dllを同梱
・字幕の色が白色の時には色の指定を省略した

2011-08-25
0,1,0,1
・Caption2Ass_PC.exeとして公開
・字幕の位置・色・ルビ(ふりがな)に対応

2011-08-XX
0,1,0,0
・「Caption2Ass 補完計画（Cleanup code）」をVC++2010でビルドしただけ。
  ここが、出発点。
